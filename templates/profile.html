{% extends "base.html" %} 
{% load staticfiles %} 

{% block extra_css %}
<link rel='stylesheet' id='dropdown-menu-style-css' href='/static/css/my-ads.css' type='text/css' media='all' /> 
<link rel='stylesheet' id='dropdown-menu-style-css' href='/static/css/dropdown-menu-style.css?v=1' type='text/css' media='all' /> 

{% block own_css %}
<style type="text/css">
.content-right-content.my-ads .ads_list .my_add .actions .status {
    border: none !important;
    width: auto !important;
    margin-right: 0px !important;
}
</style>
{% endblock %}

{% endblock %} 

{% block page_content %}

<div id="page" class="site">
    <div class="site-inner">
        <div id="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="admin-content-menu-and-content-section clearfix">
                        <!-- Content Left Section -->
                        <div class="col-md-2 col-sm-12 md-media-full-widht no-padding admin-content-left-section">
                            <!-- Logo Section -->
                            <div class="logo-section clearfix">

                                <div class="navbar-brand-profile">
                                    <a href="/" class="custom-logo-link" rel="home" itemprop="url"><img width="240" height="67" src="/static/img/cropped-logo.png" class="custom-logo" alt="" itemprop="logo" /></a>
                                </div>
                            </div>
                            <!-- End Logo Section -->

                            <!-- Header -->

                            <header>
                                <div class="left-menu-bar">
                                    <div class="cd-dropdown-wrapper">
                                        <div class="menu-button-center">
                                            <a class="cd-dropdown-trigger" href="#0"><i class="fa fa-bars" aria-hidden="true"></i></a>
                                        </div>

                                        <nav class="cd-dropdown">
                                            <a href="#0" class="cd-close">Close</a>
                                            <div class="menu-profile-side-menu-container">
                                                <ul id="menu-profile-side-menu" class="cd-dropdown-content">
                                                    <li id="menu-item-42" class="home menu-item menu-item-type-custom menu-item-object-custom menu-item-42"><a href="/profile/" class="">Home</a></li>
                                                    {% if user.is_authenticated %}
                                                        <li id="menu-item-43" class="ads menu-item menu-item-type-custom menu-item-object-custom menu-item-43"><a href="/my-ads" class="">My Ads</a></li>
                                                        <li id="menu-item-44" class="account menu-item menu-item-type-custom menu-item-object-custom menu-item-44"><a href="#/my-account" class="">My Account</a></li>
                                                        <li id="menu-item-260" class="account menu-item menu-item-type-post_type menu-item-object-page menu-item-260"><a href="#/my-subscribe" class="">My Subscribe</a></li>
                                                        <li id="menu-item-45" class="favorites menu-item menu-item-type-custom menu-item-object-custom menu-item-45"><a href="#/my-favourites" class="">My Favorites</a></li>
                                                        <li id="menu-item-46" class="logout menu-item menu-item-type-custom menu-item-object-custom menu-item-46"><a href="/logout" class="">Log Out</a></li>
                                                    {% endif %}
                                                </ul>
                                            </div>
                                        </nav>
                                        <!-- .cd-dropdown -->
                                    </div>
                                </div>
                            </header>
                            <!-- End Header -->
                        </div>

                        <div class="col-md-10 col-sm-12 md-media-full-widht no-padding">
                            <!-- Content Right Header -->
                            <div class="col-sm-12 no-padding">
                                <!-- Header User Section -->
                                <div class="header-user-section clearfix">
                                {% if user.is_authenticated %}
                                    <div class="header-user-section-ico">
                                        <a href="#"><img src="/static/img/big_avatar.png" alt=""></a>
                                    </div>
                                    <div class="header-user-section-message-to-ico">
                                        <a href="#/my-messages">
                                            <i class="fa fa-envelope" aria-hidden="true"></i>
                                        </a>
                                    </div>
                                    <div class="header-user-section-welcome">
                                        Welcome, {{ user.username }}!
                                    </div>
                                {% endif %}
                                </div>
                                <!-- End Header User Section -->
                            </div>

                            {% block right_content %}
                            <!-- Content Right Content -->
                            <div class="col-sm-12">
                                <div class="content-right-content">
                                    <nav class="breadcrumb">
                                        <a class="breadcrumb-item" href="/profile/">worldwide<i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>
                                        <!--<a class="breadcrumb-item" href="#"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>-->
                                    </nav>
                                    <span id="world_link"><a href="#">World</a></span>

                                    <!-- Content Full Width Map Img -->

                                    <div class="full-map-img">

                                        <!--  <div id="mapdiv"></div> -->

                                    </div>

                                    <div id="demo-wrapper">
                                        <div id="mapBox">
                                            <div id="up"></div>
                                            <div class="selector" style="display:none">
                                                <button id="btn-prev-map" class="prev-next"><i class="fa fa-angle-left"></i></button>
                                                <select id="mapDropdown" class="ui-widget combobox"></select>
                                                <button id="btn-next-map" class="prev-next"><i class="fa fa-angle-right"></i></button>
                                                <input type="hidden" id="cn_code" value="US">
                                            </div>
                                            <div id="container"></div>
                                        </div>
                                    </div>

                                    <!-- End Content Full Width Map Img -->

                                    <div class="1" id="nearest">
                                    </div>

                                    <!-- Content Full Select Country -->
                                    <h3 id="title_of_list">
                                        {% if request.GET.state_id or request.GET.mycusid %}
                                            Select Regions            
                                        {% else %}
                                            Select Country
                                        {% endif %}
                                    </h3>

                                    <div class="content-select-country clearfix">   
                                        {% autoescape off %}{{ rndr_str }}{% endautoescape %} 
                                    </div>

<!--                                     <div class="content-recent-ads ads_list">
                                        <h3>Recent Ads</h3>
                                    </div>
 -->

                                    <div class="btn-view-all-center">
                                        <a href="/view-all/" class="btn btn-default btn-view-all">
                                            View All Ads
                                        </a>
                                    </div>

                                </div>
                                <div class="loader_content"></div>

                            </div>
                            <!-- End Content Right Content -->
                            {% endblock %}

                            <div class="modal fade" id="subscribe-myModal" role="dialog">
                                <div class="modal-dialog view-modal-dialog">

                                    <!-- Modal content-->
                                    <div class="modal-content comman-modal subscribe-modal">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                            <h4 class="modal-title">Subscribe to Search</h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="modal-service">
                                                <span class="small-text">you are about to subscribe to following search</span>
                                                <p>finance + finance1</p>
                                            </div>
                                            <div class="modal-service">
                                                <span class="small-text">in the following region</span>
                                                <p>Worldwide</p>
                                            </div>
                                            <div class="modal-service">
                                                <span class="small-text">in the following category</span>
                                                <p>Finance</p>
                                            </div>
                                            <p class="subscribe-info">you would receive mails daily, around 6 am GMT</p>
                                            <div class="">
                                                <input class="btn btn-info msg-send-btn experience-send-btn" name="" value="Confirm" type="button">
                                                <button type="button" class="btn btn-default cancel-btn" data-dismiss="modal">cancel</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- .md-media-full-widht -->

                    </div>
                    <!-- .admin-content-menu-and-content-section -->

                </div>
                <!-- .row -->

            </div>
            <!-- .container-fluid -->

        </div>
        <!-- .site-content -->

    </div>
    <!-- .site-inner -->

</div>
<!-- .site -->

{% endblock %} 

{% block extra_js %}

{% block load_highcharts_js %}
<script src="/static/js/highmaps.js"></script>
<script src="/static/js/index.js"></script>
{% endblock %}

{% block own_js %}
<script type="text/javascript">
    var baseMapPath = "https://code.highcharts.com/mapdata/";
    var mapName = 'custom/world';

    if (location.hash)
        mapName = location.hash.substring(1);

    loadMap();

    function loadMap() {
        if (Highcharts.maps[mapName]) {
            mapReady();
        } else {
            $.getScript(baseMapPath+mapName+'.js', mapReady);
        }        
    }    

    function mapReady() {
        var mapGeoJSON = Highcharts.maps[mapName],
            data = [];

        $.each(mapGeoJSON.features, function(index, feature) {
            data.push({
                key: feature.properties['hc-key'],
                value: index
            });
        });

        $("#container").highcharts('Map', {
            title: {
                text: ''
            },
            mapNavigation: {
                enabled: true,
            },
            colorAxis: {
                min: 0,
                stops: [
                    [0, '#EFEFFF'],
                    [0.5, Highcharts.getOptions().colors[0]],
                    [1, Highcharts.Color(Highcharts.getOptions().colors[0]).brighten(-0.5).get()]
                ]
            },
            legend: {
                layout: 'vertical',
                align: 'left',
                verticalAlign: 'bottom'
            },

            series: [{
                data: data,
                mapData: mapGeoJSON,
                joinBy: ['hc-key', 'key'],
                name: 'Random data',
                states: {
                    hover: {
                        color: Highcharts.getOptions().colors[2]
                    }
                },
                dataLabels: {
                    //enabled: showDataLabels,
                    //format: '{point.name}',
                    formatter: function() {
                        return mapName === 'custom/world' ?
                            (this.point.properties && this.point.properties['hc-a2']) :
                            this.point.name;
                    }
                },
                point: {
                    events: {
                        // On click, look for a detailed map
                        click: function() {
                            var key = this.key;
                            var sec_name = '';

                            mapName = 'countries/' + key.substr(0, 2) + '/' + key + '-all';

                            $.each(Highcharts.mapDataIndex, function(mapGroup, maps) {
                                if (mapGroup !== "version") {
                                    $.each(maps, function(desc, path) {
                                        if (mapName+'.js' == path)
                                            sec_name = desc.split(',')[0];
                                    });
                                }
                            });                            

                            console.log(mapName);
                            console.log(sec_name);

                            if (sec_name) {
                                location.hash = mapName;
                                loadMap();
                            }

                            // var state_id, shu = 'state';
                            // var country_code = $("#cn_code").val(); //country code
                            // state_id = this.name; // state name

                            // if (country_code != "") {
                            //     state_id = country_code;
                            //     shu = 'country';
                            // } 

                            // $("#cn_code").val("");
                            // breadcrumb(state_id);
                            // fetch(state_id, sec_name);

                            // if (state_id.substring(2,3) == '-' && shu == 'country') {
                            //     state_id = this.name;
                            //     shu = 'state';
                            // }

                            // home_recent_ads(state_id, shu);
                        }
                    }
                }
            }, {
                type: 'mapline',
                name: "Separators",
                data: Highcharts.geojson(mapGeoJSON, 'mapline'),
                nullColor: 'gray',
                showInLegend: false,
                enableMouseTracking: false
            }]
        });        
    }
</script>
{% endblock %}

<script type="text/javascript">
    //open/close mega-navigation for mobile
    $('.cd-dropdown-trigger').on('click', function(event) {
        event.preventDefault();
        toggleNav();
    });

    //close meganavigation
    $('.cd-dropdown .cd-close').on('click', function(event) {
        event.preventDefault();
        toggleNav();
    });

    function toggleNav() {
        var navIsVisible = (!$('.cd-dropdown').hasClass('dropdown-is-active')) ? true : false;
        $('.cd-dropdown').toggleClass('dropdown-is-active', navIsVisible);
        $('.cd-dropdown-trigger').toggleClass('dropdown-is-active', navIsVisible);
        if (!navIsVisible) {
            $('.cd-dropdown').one('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend', function() {
                $('.has-children ul').addClass('is-hidden');
                $('.move-out').removeClass('move-out');
                $('.is-active').removeClass('is-active');
            });
        }
    }
</script>
{% endblock %}